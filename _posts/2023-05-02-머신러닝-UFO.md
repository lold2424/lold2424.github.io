---
layout: single

title: "íŒŒì´ì¬ web-app UFOë§Œë“¤ì–´ ë³´ê¸°"

date: 2023-05-02 18:00:00 +0900
lastmod: 2023-05-02 18:00:00 +0900 # sitemap.xmlì—ì„œ ì‚¬ìš©ë¨

author_profile: true

header:
  overlay_image: https://user-images.githubusercontent.com/91832324/235637861-3dd92595-2fd4-4178-a736-7efbed626641.jpg
  overlay_filter: 0.5 # íˆ¬ëª…ë„

categories: 
  - College Python

tags: 
    - Python
    - College

# table of contents
toc: true # ì˜¤ë¥¸ìª½ ë¶€ë¶„ì— ëª©ì°¨ë¥¼ ìë™ ìƒì„±í•´ì¤€ë‹¤.
toc_label: "table of content" # toc ì´ë¦„ ì„¤ì •
toc_icon: "bars" # ì•„ì´ì½˜ ì„¤ì •
toc_sticky: true # ë§ˆìš°ìŠ¤ ìŠ¤í¬ë¡¤ê³¼ í•¨ê»˜ ë‚´ë ¤ê°ˆ ê²ƒì¸ì§€ ì„¤ì •
---

# ML ëª¨ë¸ ì‚¬ìš©í•˜ì—¬ Web App ë§Œë“¤ê¸°

> í•´ë‹¹ í¬ìŠ¤íŠ¸ëŠ” [https://github.com/microsoft/ML-For-Beginners/tree/main/3-Web-App](https://github.com/microsoft/ML-For-Beginners/tree/main/3-Web-App)ë¥¼ ì°¸ì¡°í–ˆìŠµë‹ˆë‹¤.
> 

ë°ì´í„°ì…‹ì€ [Kaggle](https://www.kaggle.com/NUFORC/ufo-sightings)ì—ì„œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.

## ë„êµ¬

ì‘ì—…ì—ì„œ, 2ê°€ì§€ ë„êµ¬ê°€ í•„ìš”í•©ë‹ˆë‹¤

1. [Flask](https://palletsprojects.com/p/flask/)ëŠ” ë¬´ì—‡ì¼ê¹Œìš”? ì‘ì„±ìê°€ 'micro-framework'ë¡œ ì •ì˜í•œ, FlaskëŠ” Pythonìœ¼ë¡œ ì›¹ í”„ë ˆì„ì›Œí¬ì˜ ê¸°ë³¸ì ì¸ ê¸°ëŠ¥ê³¼ ì›¹ í˜ì´ì§€ë¥¼ ë§Œë“œëŠ” í…œí”Œë¦¿ ì—”ì§„ì„ ì œê³µí•©ë‹ˆë‹¤. [this Learn module](https://docs.microsoft.com/learn/modules/python-flask-build-ai-web-app?WT.mc_id=academic-77952-leestott)ì„ ë³´ê³  Flaskë¡œ ë§Œë“œëŠ” ê²ƒì„ ì—°ìŠµí•©ë‹ˆë‹¤.
2. [Pickle](https://docs.python.org/3/library/pickle.html)ì€ ë¬´ì—‡ì¼ê¹Œìš”? Pickle ğŸ¥’ì€ Python ê°ì²´ êµ¬ì¡°ë¥¼ serializesì™€ de-serializesí•˜ëŠ” Python ëª¨ë“ˆì…ë‹ˆë‹¤. ëª¨ë¸ì„ 'pickle'í•˜ê²Œ ë˜ë©´, ì›¹ì—ì„œ ì“°ê¸° ìœ„í•´ì„œ serialize ë˜ëŠ” flattení•©ë‹ˆë‹¤. ì£¼ì˜í•©ì‹œë‹¤: pickleì€ ì›ë˜ ì•ˆì „í•˜ì§€ ì•Šì•„ì„œ, íŒŒì¼ì„ 'un-pickle'í•œë‹¤ê³  ë‚˜ì˜¤ë©´ ì¡°ì‹¬í•©ë‹ˆë‹¤. pickled íŒŒì¼ì€ ì ‘ë¯¸ì‚¬ `.pkl`ë¡œ ìˆìŠµë‹ˆë‹¤. 

## ë°ì´í„° ì •ë¦¬í•˜ê¸°

[NUFORC](https://nuforc.org) (The National UFO Reporting Center)ì—ì„œ ëª¨ì•„ë‘”, 80,000 UFO ëª©ê²© ë°ì´í„°ë¥¼ ì´ ê°•ì˜ì—ì„œ ì‚¬ìš©í•©ë‹ˆë‹¤. ë°ì´í„°ì— UFO ëª©ê²© ê´€ë ¨í•œ ëª‡ í¥ë¯¸ë¡œìš´ ì„¤ëª…ì´ ìˆìŠµë‹ˆë‹¤, ì˜ˆì‹œë¡œ ë“¤ì–´ë´…ë‹ˆë‹¤:

- **ê¸´ ì˜ˆì‹œë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤.**"A man emerges from a beam of light that shines on a grassy field at night and he runs towards the Texas Instruments parking lot".
- **ì§§ì€ ì˜ˆì‹œë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤.** "the lights chased us".

[ufos.csv](.././data/ufos.csv) ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì—ëŠ” ëª©ê²©ëœ `city`, `state` ì™€ `country`, ì˜¤ë¸Œì íŠ¸ì˜ `shape` ì™€ `latitude` ë° `longitude` ì—´ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

ê°•ì˜ì— ìˆëŠ” ë¹ˆ [notebook](../notebook.ipynb)ì—ì„œ ì§„í–‰í•©ë‹ˆë‹¤:

1. `pandas`, `matplotlib`, ì™€ `numpy`ë¥¼ importí•˜ê³  ufos ìŠ¤í”„ë ˆë“œì‹œíŠ¸ë„ importí•©ë‹ˆë‹¤. ìƒ˜í”Œ ë°ì´í„°ì…‹ì„ ì¶œë ¥í•œë‹¤:

```python
import pandas as pd
import numpy as np
    
ufos = pd.read_csv('./data/ufos.csv')
ufos.head()
```

1. ufos ë°ì´í„°ë¥¼ ìƒˆë¡œìš´ ì œëª©ì˜ ì‘ì€ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. `Country` í•„ë“œê°€ ìœ ë‹ˆí¬ ê°’ì¸ì§€ í™•ì¸í•©ë‹ˆë‹¤.

```python
ufos = pd.DataFrame({'Seconds': ufos['duration (seconds)'], 'Country': ufos['country'],'Latitude': ufos['latitude'],'Longitude': ufos['longitude']})
    
ufos.Country.unique()
```

1. ì§€ê¸ˆë¶€í„°, ëª¨ë“  null ê°’ì„ ë“œëí•˜ê³  1-60ì´ˆ ì‚¬ì´ ëª©ê²©ë§Œ ê°€ì ¸ì™€ì„œ ì²˜ë¦¬í•  ë°ì´í„°ì˜ ìˆ˜ëŸ‰ì„ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```python
ufos.dropna(inplace=True)
    
ufos = ufos[(ufos['Seconds'] >= 1) & (ufos['Seconds'] <= 60)]
    
ufos.info()
```

1. Scikit-learnì˜ `LabelEncoder` ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ Importí•´ì„œ êµ­ê°€ì˜ í…ìŠ¤íŠ¸ ê°’ì„ ìˆ«ìë¡œ ë³€í™˜í•©ë‹ˆë‹¤:
    
    LabelEncoderëŠ” ë°ì´í„°ë¥¼ ì•ŒíŒŒë²³ ìˆœì„œë¡œ ì¸ì½”ë“œí•©ë‹ˆë‹¤.
    

```python
from sklearn.preprocessing import LabelEncoder
    
ufos['Country'] = LabelEncoder().fit_transform(ufos['Country'])
    
ufos.head()
```

## ëª¨ë¸ ë§Œë“¤ê¸°

ì§€ê¸ˆë¶€í„° ë°ì´í„°ë¥¼ í›ˆë ¨í•˜ê³  í…ŒìŠ¤íŠ¸í•  ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ„ì–´ì„œ ëª¨ë¸ì„ í›ˆë ¨í•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.

1. X ë°±í„°ë¡œ í›ˆë ¨í•  3ê°€ì§€ featuresë¥¼ ì„ íƒí•˜ë©´, y ë°±í„°ëŠ” `Country`ë¡œ ë©ë‹ˆë‹¤. `Seconds`, `Latitude` ì™€ `Longitude`ë¥¼ ì…ë ¥í•˜ë©´ êµ­ê°€ idë¡œ ë°˜í™˜ë˜ê¸°ë¥¼ ì›í•©ë‹ˆë‹¤.
    
    ```python
    from sklearn.model_selection import train_test_split
        
    Selected_features = ['Seconds','Latitude','Longitude']
        
    X = ufos[Selected_features]
    y = ufos['Country']
        
    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)
    ```
    
2. logistic regressionì„ ì‚¬ìš©í•´ì„œ ëª¨ë¸ì„ í›ˆë ¨í•©ë‹ˆë‹¤
    
    ```python
    from sklearn.preprocessing import LabelEncoder
        
    ufos['Country'] = LabelEncoder().fit_transform(ufos['Country'])
        
    ufos.head()
    ```
    

ë‹¹ì—°í•˜ê²Œ,Â `Country`Â ì™€Â `Latitude/Longitude`ê°€ ìƒê´€ ê´€ê³„ìˆì–´ì„œ, ì •í™•ë„Â **(around 95%)**Â ê°€ ë‚˜ì˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

## **ëª¨ë¸ 'pickle'í•˜ê¸°**

ëª¨ë¸ì„Â *pickle*Â í•  ì‹œê°„ì´ ë˜ì—ˆìŠµë‹ˆë‹¤! ì½”ë“œ ëª‡ ì¤„ë¡œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.Â *pickled*Â ë˜ë©´, pickled ëª¨ë¸ì„ ë¶ˆëŸ¬ì™€ì„œ ì´ˆ, ìœ„ë„ì™€ ê²½ë„ ê°’ì´ í¬í•¨ëœ ìƒ˜í”Œ ë°ì´í„° ë°°ì—´ì„ ëŒ€ìƒìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤.

```python
import pickle
model_filename = 'ufo-model.pkl'
pickle.dump(model, open(model_filename,'wb'))

model = pickle.load(open('ufo-model.pkl','rb'))
print(model.predict([[50,44,-12]]))
```

ëª¨ë¸ì€ ì˜êµ­ êµ­ê°€ ì½”ë“œì¸,Â **'3'**Â ì´ ë°˜í™˜ë©ë‹ˆë‹¤

## **Flask ì•± ë§Œë“¤ê¸°**

ì§€ê¸ˆë¶€í„° Flask ì•±ì„ ë§Œë“¤ì–´ì„œ ëª¨ë¸ì„ ë¶€ë¥´ê³  ë¹„ìŠ·í•œ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ì§€ë§Œ, ì‹œê°ì ìœ¼ë¡œ ë§Œì¡±í•  ë°©ì‹ìœ¼ë¡œë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.

1. *ufo-model.pkl*Â íŒŒì¼ê³¼Â *notebook.ipynb*Â íŒŒì¼ ì˜†ì—Â **web-app**Â ì´ë¼ê³  ë¶ˆë¦¬ëŠ” í´ë”ë¥¼ ë§Œë“¤ë©´ì„œ ì‹œì‘í•©ë‹ˆë‹¤.
2. í´ë”ì—ì„œ 3ê°€ì§€ í´ë”ë¥¼ ë§Œë“­ë‹ˆë‹¤:Â **static**, ë‚´ë¶€ì—Â **css**Â í´ë”ê°€ ìˆìœ¼ë©°,Â **templates`**Â ë„ ìˆìŠµë‹ˆë‹¤. ì§€ê¸ˆë¶€í„° ë‹¤ìŒ íŒŒì¼ê³¼ ë””ë ‰í† ë¦¬ë“¤ì´ ìˆì–´ì•¼ í•œë‹¤.
    - web-app/
    - static/
    - css/
    - templates/
    - notebook.ipynb
    - ufo-model.pkl
3. *web-app*Â í´ë”ì—ì„œ ë§Œë“¤ ì²« íŒŒì¼ì€Â **requirements.txt**Â íŒŒì¼ì…ë‹ˆë‹¤. JavaScript ì•±ì˜Â *package.json*Â ì²˜ëŸ¼, ì•±ì— í•„ìš”í•œ ì˜ì¡´ì„±ì„ ë¦¬ìŠ¤íŠ¸í•œ íŒŒì¼ì…ë‹ˆë‹¤.Â **requirements.txt**Â ì— í•´ë‹¹ ë¼ì¸ì„ ì¶”ê°€í•©ë‹ˆë‹¤:
    
    ```python
    scikit-learn
    pandas
    numpy
    flask
    ```
    
4. *web-app*Â ìœ¼ë¡œ ì´ë™í•´ì„œ íŒŒì¼ì„ í•˜ë©´ ëœë‹¤.
    
    ```python
    cd web-app
    ```
    
5. í„°ë¯¸ë„ì—ì„œÂ `pip install`ì„ íƒ€ì´í•‘í•´ì„œ,Â *requirements.txt*Â ì— ë‚˜ì—´ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤:
    
    ```python
    pip install -r requirements.txt
    ```
    
6. ì§€ê¸ˆë¶€í„°, ì•±ì„ ì™„ì„±í•˜ê¸° ìœ„í•´ì„œ 3ê°€ì§€ íŒŒì¼ì„ ë” ë§Œë“ ë‹¤.
    1. ìµœìƒë‹¨ì—Â **app.py**ë¥¼ ë§Œë“­ë‹ˆë‹¤.
    2. *templates*Â ë””ë ‰í† ë¦¬ì—Â **index.html**ì„ ë§Œë“­ë‹ˆë‹¤.
    3. *static/css*Â ë””ë ‰í† ë¦¬ì—Â **styles.css**ë¥¼ ë§Œë“­ë‹ˆë‹¤.
7. ëª‡ ìŠ¤íƒ€ì¼ë¡œÂ *styles.css*Â íŒŒì¼ì„ ë§Œë“­ë‹ˆë‹¤:
    
    ```css
    body {
    	width: 100%;
    	height: 100%;
    	font-family: 'Helvetica';
    	background: black;
    	color: #fff;
    	text-align: center;
    	letter-spacing: 1.4px;
    	font-size: 30px;
    }
    
    input {
    	min-width: 150px;
    }
    
    .grid {
    	width: 300px;
    	border: 1px solid #2d2d2d;
    	display: grid;
    	justify-content: center;
    	margin: 20px auto;
    }
    
    .box {
    	color: #fff;
    	background: #2d2d2d;
    	padding: 12px;
    	display: inline-block;
    }
    ```
    
8. ë‹¤ìŒìœ¼ë¡œÂ *index.html*Â íŒŒì¼ì„ ë§Œë“­ë‹ˆë‹¤:
    
    ```html
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="UTF-8">
      <title>ğŸ›¸ UFO Appearance Prediction! ğŸ‘½</title>
      <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}"> 
    </head>
    
    <body>
     <div class="grid">
    
      <div class="box">
    
      <p>According to the number of seconds, latitude and longitude, which country is likely to have reported seeing a UFO?</p>
    
        <form action="{{ url_for('predict')}}" method="post">
        	<input type="number" name="seconds" placeholder="Seconds" required="required" min="0" max="60" />
          <input type="text" name="latitude" placeholder="Latitude" required="required" />
    		  <input type="text" name="longitude" placeholder="Longitude" required="required" />
          <button type="submit" class="btn">Predict country where the UFO is seen</button>
        </form>
    
      
       <p>{{ prediction_text }}</p>
    
     </div>
    </div>
    
    </body>
    </html>
    ```
    
9. `app.py`Â ì— ì•„ë˜ ì½”ë“œë¥¼ ì…ë ¥í•´ì¤€ë‹¤.
    
    ```python
    import numpy as np
    from flask import Flask, request, render_template
    import pickle
    
    app = Flask(__name__)
    
    model = pickle.load(open("./ufo-model.pkl", "rb"))
    
    @app.route("/")
    def home():
        return render_template("index.html")
    
    @app.route("/predict", methods=["POST"])
    def predict():
    
        int_features = [int(x) for x in request.form.values()]
        final_features = [np.array(int_features)]
        prediction = model.predict(final_features)
    
        output = prediction[0]
    
        countries = ["Australia", "Canada", "Germany", "UK", "US"]
    
        return render_template(
            "index.html", prediction_text="Likely country: {}".format(countries[output])
        )
    
    if __name__ == "__main__":
        app.run(debug=True)
    ```
    

## ë§Œë“¤ì–´ì§„ web-appì„ ë™ì‘ì‹œì¼œë³´ê¸°

vscodeë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë™ì‘ì‹œì¼°ë‹¤ ë‹¤ì–‘í•œ ë°©ë²•ìœ¼ë¡œ ë™ì‘ì´ ê°€ëŠ¥í•˜ë‚˜ ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ í•´ë„ ìƒê´€ì€ ì—†ë‹¤.

1. app.pyì˜ í„°ë¯¸ë„ì„ ì‹¤í–‰ì‹œí‚¨ë‹¤.

![Untitled](https://user-images.githubusercontent.com/91832324/235637873-ce51692d-6e46-49eb-be54-68d5d2fb8485.png)

1. ë¯¸ë¦¬ ë§Œë“¤ì–´ë‘” requirements.txt íŒŒì¼ì— ë™ì‘ì‹œí‚¤ê¸° ìœ„í•´ í•„ìš”í•œ ëª¨ë“ˆì˜ ì •ë³´ê°€ ë“¤ì–´ìˆë‹¤. ì´ íŒŒì¼ì„ ì´ìš©í•´ì„œ ëª¨ë“ˆì„ ë‹¤ìš´ë°›ëŠ”ë‹¤.
ì•„ë˜ ì½”ë“œë¥¼ í„°ë¯¸ë„ì— ì…ë ¥í•˜ë©´ ëœë‹¤.
    
    ```python
    pip install -r requirements.txt
    ```
    
2. ì´í›„ ë§Œë“¤ì–´ì§„ app.pyë¥¼ ê°€ë™ì‹œí‚¤ê¸° ìœ„í•´ ì•„ë˜ ì½”ë“œë¥¼ í„°ë¯¸ë„ì— ì…ë ¥í•œë‹¤.
    
    ```python
    python app.py
    ```
    
    ![Untitled 1](https://user-images.githubusercontent.com/91832324/235637870-556ed8dc-0c9f-4fa8-a683-920af9bd3b3b.png)
    
    ìœ„ ì‚¬ì§„ê³¼ ê°™ì´ ëœ¨ë©´ ì„±ê³µì´ë‹¤.
    
3. [http://127.0.0.1:5000](http://127.0.0.1:5000/)ë§í¬ì— ë“¤ì–´ê°€ë©´ ëœë‹¤.
4. ì•„ë˜ ì‚¬ì§„ì²˜ëŸ¼ ê°’ì„ ì…ë ¥í•˜ë©´ ìœ„ì„±ì˜ ìœ„ì¹˜ë¥¼ ì•Œ ìˆ˜ ìˆë‹¤.
    
    ![%EC%82%AC%EC%9A%A9%ED%99%94%EB%A9%B42](https://user-images.githubusercontent.com/91832324/235637879-7c6764d2-6734-4e41-b66c-8fdf81c29b41.png)
    
    ![%EC%82%AC%EC%9A%A9_%ED%99%94%EB%A9%B41](https://user-images.githubusercontent.com/91832324/235637883-7bf333ca-7b61-4676-a4fb-15c4e84d562a.png)